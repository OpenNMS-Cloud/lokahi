<blueprint
    xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
                http://www.osgi.org/xmlns/blueprint/v1.0.0 https://osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd">

    <bean id="identity" class="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.IdentityImpl" />
    <bean id="dnsResolver" class="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.DnsResolverImpl" />
    <bean id="eventForwarder" class="org.opennms.netmgt.telemetry.protocols.netflow.parser.xml.event.EventForwarderImpl" />
    <bean id="telemetryRegistry" class="org.opennms.netmgt.telemetry.listeners.factory.TelemetryRegistryImpl" />


    <!-- Netflow 5 UDP Parser Factory -->
    <bean id="netflow5UdpParserFactory" class="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.Netflow5UdpParserFactory">
        <argument ref="telemetryRegistry" />
        <argument ref="eventForwarder" />
        <argument ref="identity" />
        <argument ref="dnsResolver" />
    </bean>
    <service ref="netflow5UdpParserFactory" interface="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.ParserFactory">
        <service-properties>
            <entry key="registration.export" value="true" />
        </service-properties>
    </service>

    <!-- Netflow 9 UDP Parser Factory -->
    <bean id="netflow9UdpParserFactory" class="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.Netflow9UdpParserFactory">
        <argument ref="telemetryRegistry" />
        <argument ref="eventForwarder" />
        <argument ref="identity" />
        <argument ref="dnsResolver" />
    </bean>
    <service ref="netflow9UdpParserFactory" interface="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.ParserFactory">
        <service-properties>
            <entry key="registration.export" value="true" />
        </service-properties>
    </service>

    <!-- IPFIX TCP Parser Factory -->
    <bean id="ipfixTcpParserFactory" class="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.IpfixTcpParserFactory">
        <argument ref="telemetryRegistry" />
        <argument ref="eventForwarder" />
        <argument ref="identity" />
        <argument ref="dnsResolver" />
    </bean>
    <service ref="ipfixTcpParserFactory" interface="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.ParserFactory">
        <service-properties>
            <entry key="registration.export" value="true" />
        </service-properties>
    </service>

    <!-- IPFIX UDP Parser Factory -->
    <bean id="ipfixUdpParserFactory" class="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.IpfixUdpParserFactory">
        <argument ref="telemetryRegistry" />
        <argument ref="eventForwarder" />
        <argument ref="identity" />
        <argument ref="dnsResolver" />
    </bean>
    <service ref="ipfixUdpParserFactory" interface="org.opennms.netmgt.telemetry.protocols.netflow.parser.factory.ParserFactory">
        <service-properties>
            <entry key="registration.export" value="true" />
        </service-properties>
    </service>
</blueprint>

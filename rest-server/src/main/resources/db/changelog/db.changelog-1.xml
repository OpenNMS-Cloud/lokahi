<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.6.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd">
    <changeSet author="YaLi (generated)" id="1649953110696-1">
        <createTable tableName="ipinterface_metadata">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ipinterface_metadata_pkey"/>
            </column>
            <column name="context" type="VARCHAR(255)"/>
            <column name="key" type="VARCHAR(255)"/>
            <column name="value" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="YaLi (generated)" id="1649953110696-2">
        <createTable tableName="ipinterfaces">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ipinterfaces_pkey"/>
            </column>
            <column name="host_name" type="VARCHAR(255)"/>
            <column name="ip_address" type="VARCHAR(255)"/>
            <column name="is_managed" type="VARCHAR(255)"/>
            <column name="is_snmp_primary" type="VARCHAR(255)"/>
            <column name="last_poll" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="net_mask" type="VARCHAR(255)"/>
            <column name="status" type="VARCHAR(255)"/>
            <column name="node_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="YaLi (generated)" id="1649953110696-3">
        <createTable tableName="location_tags">
            <column name="location_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="tags" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="YaLi (generated)" id="1649953110696-4">
        <createTable tableName="monitoring_locations">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="monitoring_locations_pkey"/>
            </column>
            <column name="geolocation" type="VARCHAR(255)"/>
            <column name="latitude" type="FLOAT8">
                <constraints nullable="false"/>
            </column>
            <column name="location" type="VARCHAR(255)"/>
            <column name="longitude" type="FLOAT8">
                <constraints nullable="false"/>
            </column>
            <column name="monitoring_area" type="VARCHAR(255)"/>
            <column name="priority" type="INTEGER">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="YaLi (generated)" id="1649953110696-5">
        <createTable tableName="node_metadata">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="node_metadata_pkey"/>
            </column>
            <column name="context" type="VARCHAR(255)"/>
            <column name="key" type="VARCHAR(255)"/>
            <column name="value" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="YaLi (generated)" id="1649953110696-6">
        <createTable tableName="nodes">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="nodes_pkey"/>
            </column>
            <column name="create_time" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="domain_name" type="VARCHAR(255)"/>
            <column name="foreign_id" type="VARCHAR(255)"/>
            <column name="foreign_source" type="VARCHAR(255)"/>
            <column name="label" type="VARCHAR(255)"/>
            <column name="label_source" type="CHAR(1)"/>
            <column name="last_egress_flow" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="last_ingress_flow" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="last_poll" type="TIMESTAMP WITHOUT TIME ZONE"/>
            <column name="net_bios_name" type="VARCHAR(255)"/>
            <column name="operating_system" type="VARCHAR(255)"/>
            <column name="sys_contact" type="VARCHAR(255)"/>
            <column name="sys_description" type="VARCHAR(255)"/>
            <column name="sys_location" type="VARCHAR(255)"/>
            <column name="sys_name" type="VARCHAR(255)"/>
            <column name="sys_oid" type="VARCHAR(255)"/>
            <column name="type" type="CHAR(1)"/>
            <column name="location_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="parent_id" type="BIGINT"/>
        </createTable>
    </changeSet>
    <changeSet author="YaLi (generated)" id="1649953110696-7">
        <addForeignKeyConstraint baseColumnNames="node_id" baseTableName="ipinterfaces" constraintName="fk_interface_nodeid" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="nodes" validate="true"/>
    </changeSet>
    <changeSet author="YaLi (generated)" id="1649953110696-8">
        <addForeignKeyConstraint baseColumnNames="location_id" baseTableName="location_tags" constraintName="fk_location_tag_locationid" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="monitoring_locations" validate="true"/>
    </changeSet>
    <changeSet author="YaLi (generated)" id="1649953110696-9">
        <addForeignKeyConstraint baseColumnNames="location_id" baseTableName="nodes" constraintName="fk_node_locationid" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="monitoring_locations" validate="true"/>
    </changeSet>
    <changeSet author="YaLi (generated)" id="1649953110696-10">
        <addForeignKeyConstraint baseColumnNames="parent_id" baseTableName="nodes" constraintName="fk_node_parentid" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="nodes" validate="true"/>
    </changeSet>
</databaseChangeLog>

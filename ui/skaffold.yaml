# nonk8s
apiVersion: skaffold/v2beta28
kind: Config
metadata:
  name: horizon-stream-ui
build:
  local:
    useBuildkit: true
  artifacts:
  - image: opennms/horizon-stream-ui
    sync:
      manual: # Inferred file sync is limited for multi-stage builds, use manual sync.
        - src: 'src/**'
          dest: .
        - src: 'public/**'
          dest: .
        - src: 'tests/**'
          dest: .
        - src: 'index.html'
          dest: .
        - src: '*.ts'
          dest: .
    docker:
      dockerfile: Dockerfile
      target: development
      buildArgs:
        VITE_BASE_URL: "/api"
        VITE_KEYCLOAK_URL: "/auth"
portForward:
  - resourceType: deployment
    resourceName: opennms-ui
    namespace: skaffold-instance
    port: 80 # nginx HTTP
    localPort: 3000
profiles:
  - name: prod
    build:
      artifacts:
      - image: opennms/horizon-stream-ui
        docker:
          dockerfile: Dockerfile
